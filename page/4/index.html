<!doctype html>



  


<html class="theme-next pisces use-motion">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.0.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.0.2" />






<meta name="description" content="数据挖掘，iOS，python，现在就职业京东金融">
<meta property="og:type" content="website">
<meta property="og:title" content="Hanson的博客">
<meta property="og:url" content="/page/4/index.html">
<meta property="og:site_name" content="Hanson的博客">
<meta property="og:description" content="数据挖掘，iOS，python，现在就职业京东金融">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Hanson的博客">
<meta name="twitter:description" content="数据挖掘，iOS，python，现在就职业京东金融">



<script type="text/javascript" id="hexo.configuration">
  var NexT = window.NexT || {};
  var CONFIG = {
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    }
  };
</script>




  <link rel="canonical" href="/page/4/"/>


  <title> Hanson的博客 </title>
</head>

<body itemscope itemtype="//schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="//schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Hanson的博客</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
            标签
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup">
 <span class="search-icon fa fa-search"></span>
 <input type="text" id="local-search-input">
 <div id="local-search-result"></div>
 <span class="popup-btn-close">close</span>
</div>


    </div>
  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="//schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/10/20/iOS安全-符号表/" itemprop="url">
                  iOS安全--符号表
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2017-10-20T09:24:17+08:00" content="2017-10-20">
              2017-10-20
            </time>
          </span>

          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>符号表中有些符号是必须的，但是很多符号都是去掉的。</p>
<p>先来看一个正常的二进制文件的符号表：</p>
<p>IOS安全–使用strip从符号表中去掉不需要的符号</p>
<p>从上面我们可以看到很多暴露的类名、函数名等，这让攻击者很容易看出你的程序中有哪些关键的逻辑。但是我们对该文件strip后，再来看它的符号表：</p>
<p><code>strip JDMobile</code></p>
<p>IOS安全–使用strip从符号表中去掉不需要的符号</p>
<p>这时我们看到程序中定义的函数在符号表中都没有了。</p>
<p>而且这样在反汇编的代码中也不会存在符号。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="//schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/10/20/ios编译过程/" itemprop="url">
                  ios编译过程
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2017-10-20T09:19:20+08:00" content="2017-10-20">
              2017-10-20
            </time>
          </span>

          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>看一下ios项目的归档构建流程:</p>
<ul>
<li><p>准备构建环境，构建目录</p>
</li>
<li><p>编译主工程依赖的Pods工程的静态库或者Framework (=== BUILD TARGET Aspects OF PROJECT Pods WITH CONFIGURATION Debug ===)</p>
</li>
<li><p>编译主工程的源代码文件 (CompileC)</p>
</li>
<li><p>链接生成主工程对应的可执行文件 (Ld)</p>
</li>
<li><p>拷贝图片，localized字符串等资源文件 (CpResource)</p>
</li>
<li><p>编译storyboard文件 (CompileStoryboard)</p>
</li>
<li><p>CompileAssetCatalog</p>
</li>
<li><p>处理pinfo.list文件 (ProcessInfoPlistFile)</p>
</li>
<li><p>生成符号表文件(GenerateDSYMFile)</p>
</li>
<li><p>链接StoryBoard(LinkStoryboards)</p>
</li>
<li><p>执行配置的脚本文件(PhaseScriptExecution)</p>
</li>
<li><p>打包生成app文件，不是ipa文件(ProcessProductPackaging)</p>
</li>
<li><p>签名 (CodeSign)</p>
</li>
<li><p>校验 (Validate)</p>
</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="//schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/10/16/ipa自动创建上传功能构建/" itemprop="url">
                  ipa自动创建上传功能构建
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2017-10-16T16:57:26+08:00" content="2017-10-16">
              2017-10-16
            </time>
          </span>

          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <p>我们其实是对Application Loader功能进行脚本化<br>
          <div class="post-more-link text-center">
            <a class="btn" href="/2017/10/16/ipa自动创建上传功能构建/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="//schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/10/11/hexo多端同步错误解决方案/" itemprop="url">
                  hexo多端同步错误解决方案
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2017-10-11T22:00:15+08:00" content="2017-10-11">
              2017-10-11
            </time>
          </span>

          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><code>hexo d</code>这个命令是相当于直接<code>git push</code>，如果只有一台机器那么是没有问题，但是如果是两台机器，那么还少一步<code>git pull</code>，所以如果是两台机器同时维护一个库的时候需要</p>
<ul>
<li>进入到<code>.deploy_git</code>这个目录下</li>
<li>然后执行<code>git pull origin master --allow-unrelated-histories</code></li>
<li>然后再push</li>
<li>执行<code>hexo d</code>就好了</li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="//schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/10/11/2016/转-block进阶1-block实现/" itemprop="url">
                  未命名
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2017-10-11T18:13:43+08:00" content="2017-10-11">
              2017-10-11
            </time>
          </span>

          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <hr>
<p>title: (转)block进阶1–block实现<br>date: 2016-06-29 14:15:20<br>tags:</p>
<ul>
<li>iOS进阶<br>categories: iOS</li>
</ul>
<hr>
<p>本系列博文总结自《Pro Multithreading and Memory Management for iOS and OS X with ARC》</p>
          <div class="post-more-link text-center">
            <a class="btn" href="/2017/10/11/2016/转-block进阶1-block实现/#more" rel="contents">
              阅读全文 &raquo;
            </a>
          </div>
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="//schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/10/11/python学习环境搭建-jupyter-notebook/" itemprop="url">
                  python学习环境搭建-jupyter notebook
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2017-10-11T11:35:30+08:00" content="2017-10-11">
              2017-10-11
            </time>
          </span>

          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="先说一下好处："><a href="#先说一下好处：" class="headerlink" title="先说一下好处："></a>先说一下好处：</h3><p>我们学习python可以在命令行输入python直接进入python环境进行练习，但是问题是多行运行比较繁琐，这里我们推荐使用jupyter来运行代码</p>
<h3 id="再说一下环境-："><a href="#再说一下环境-：" class="headerlink" title="再说一下环境 ："></a>再说一下环境 ：</h3><p>MAC台式机</p>
<p>python:mac下自带Python 2.7.10</p>
<ul>
<li><p>1.先升级了pip安装工具：sudo python -m pip install –upgrade –force pip</p>
</li>
<li><p>2.安装setuptools 工具：sudo pip install setuptools==33.1.1</p>
</li>
<li><p>3.安装 Python-dateutil:sudo pip install python-dateutil==2.2</p>
</li>
<li><p>4.安装six:sudo pip install –ignore-installed six</p>
</li>
<li><p>5.安装jupyter：sudo install jupyter</p>
</li>
</ul>
<p>启动命令：直接在终端输入jupyter notebook</p>
<p>折腾了半天，才搞好，以上命令是在安装的时候遇到各种问题时使用的，下面写记录一下遇到的问题 以及对应的解决办法</p>
<p>1.ImportError: cannot import name _thread  报这个错误 解决办法：</p>
<p>sudo pip uninstall python-dateutil<br>sudo pip install python-dateutil==2.2<br>2.File “/Library/Python/2.7/site-packages/dateutil/tz/_common.py”, line 2, in <module></module></p>
<p>from six.moves import _thread<br>ImportError: cannot import name _thread</p>
<p>解决办法：安装six 命令再上方</p>
<p>解决了上面的问题 启动的时候 还是会报错这是个顽固的错误：</p>
<p>  File “/Library/Python/2.7/site-packages/packaging/requirements.py”, line 59, in <module></module></p>
<pre><code>MARKER_EXPR = originalTextFor(MARKER_EXPR())(&quot;marker&quot;)
</code></pre><p>TypeError: <strong>call</strong>() takes exactly 2 arguments (1 given)</p>
<p>解决办法：根据错误信息直接找到路径中的文件，打开文件将 59 行中的函数修改</p>
<p>59：#MARKER_EXPR = originalTextFor(MARKER_EXPR())(“marker”)<br>60：MARKER_EXPR = originalTextFor(MARKER_EXPR(“marker”))</p>
<p>修改好之后直接保存文件 再次运行jupyter notebook 命令 即可启动jupyter </p>
<p>关于six那个问题，还有一点 需要删除我们默认路径下的six 否则 即使更新成功了 也不会使用最新的six</p>
<p>方法：先查看一下默认的six路径</p>
<p> import six</p>
<h3 id="最后说一下怎么使用"><a href="#最后说一下怎么使用" class="headerlink" title="最后说一下怎么使用"></a>最后说一下怎么使用</h3><p>file–&gt;new–&gt;python2</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="//schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/10/10/python发送邮件代码记录/" itemprop="url">
                  python发送邮件代码记录
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2017-10-10T20:38:05+08:00" content="2017-10-10">
              2017-10-10
            </time>
          </span>

          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div></pre></td><td class="code"><pre><div class="line">#!/usr/bin/env python</div><div class="line">#coding:utf-8</div><div class="line"></div><div class="line">from email import encoders</div><div class="line">from email.header import Header</div><div class="line">from email.mime.text import MIMEText</div><div class="line">from email.mime.multipart import MIMEMultipart</div><div class="line">from email.mime.application import MIMEApplication</div><div class="line">from email.utils import parseaddr, formataddr</div><div class="line">import smtplib,os</div><div class="line"></div><div class="line">def _format_addr(s):</div><div class="line">    name, addr = parseaddr(s)</div><div class="line">    return formataddr(( \</div><div class="line">        Header(name, &apos;utf-8&apos;).encode(), \</div><div class="line">        addr.encode(&apos;utf-8&apos;) if isinstance(addr, unicode) else addr))</div><div class="line"></div><div class="line">def sendMail():</div><div class="line">    username = &apos;hanshenghui&apos;</div><div class="line">    password = &apos;11111111111&apos;</div><div class="line"></div><div class="line">    from_addr = &apos;hanshenghui@jd.com&apos;</div><div class="line">    to_addr = &apos;hanshenghui@jd.com&apos;</div><div class="line">    # to_addrList = [&apos;hanshenghui@jd.com&apos;,&apos;gaixutian@jd.com&apos;,&apos;wangzhenyang1@jd.com&apos;]</div><div class="line">    to_addrList = [&apos;hanshenghui@jd.com&apos;,&apos;wangxiugang@jd.com&apos;,&apos;dingchao1@jd.com&apos;]</div><div class="line">    smtp_server = &apos;smtp.jd.local&apos;</div><div class="line"></div><div class="line">    msg = MIMEMultipart()</div><div class="line">    part = MIMEText(&quot;这是一封测试邮件\n\n现在主要有以下几个待确定点:\n1.我们可以通过对数据进行提取，做一些分析和简介作为邮件的正文，或者是一些其他什么内容\n2.现在邮箱我添加了名字为JDJRMobile，实际上是我自己的邮箱，用哪个邮箱来发送比较合适\n3.检测哪个分支\n4.检测频率\n\n&quot;)</div><div class="line">    msg.attach(part)</div><div class="line">    </div><div class="line">    basePath = os.environ[&apos;HOME&apos;]</div><div class="line">    reportPath = basePath + &apos;/Documents/Build/JDJRAPPAndroid/infer-out/report.csv&apos;</div><div class="line">    if os.path.exists(reportPath):    </div><div class="line">       part1 = MIMEApplication(open(reportPath,&apos;rb&apos;).read())</div><div class="line">       part1.add_header(&apos;Content-Disposition&apos;, &apos;attachment&apos;, filename=&quot;report.csv&quot;)</div><div class="line">       msg.attach(part1)</div><div class="line"></div><div class="line">    # part2 = MIMEApplication(open(&apos;cesh.png&apos;,&apos;rb&apos;).read())</div><div class="line">    # part2.add_header(&apos;Content-Disposition&apos;, &apos;attachment&apos;, filename=&quot;cesh.png&quot;)</div><div class="line">    # msg.attach(part2)</div><div class="line"></div><div class="line">    msg[&apos;From&apos;] = _format_addr(u&apos;JDJRMobile &lt;%s&gt;&apos; % from_addr)</div><div class="line">    msg[&apos;To&apos;] = _format_addr(&apos;JDJR&apos;)</div><div class="line">    msg[&apos;Subject&apos;] = Header(u&apos;JDJR安卓源码检测报告&apos;, &apos;utf-8&apos;).encode()</div><div class="line"></div><div class="line">    server = smtplib.SMTP(smtp_server,25)</div><div class="line">    server.set_debuglevel(1)</div><div class="line">    server.sendmail(from_addr, to_addrList, msg.as_string())</div><div class="line">    server.quit()</div></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="//schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/10/10/xcode工程加密思路/" itemprop="url">
                  xcode工程加密思路
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2017-10-10T19:45:46+08:00" content="2017-10-10">
              2017-10-10
            </time>
          </span>

          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>现在有这么一个需求，如何做到如果不安装我们的开发环境，就无法查看iOS工程。<br>首先我们如果对所有的代码进行加密这肯定是一个浩大的工程，所以我们选择是对project加密，</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div></pre></td><td class="code"><pre><div class="line">/usr/bin/env python</div><div class="line">#coding:utf-8</div><div class="line"></div><div class="line">from Crypto.Cipher import AES  </div><div class="line">from binascii import b2a_hex,a2b_hex  </div><div class="line">  </div><div class="line">class prpcrypt():   #定义一个类  </div><div class="line">    def __init__(self,key):  </div><div class="line">        self.key=key  </div><div class="line">        self.mode=AES.MODE_CBC  </div><div class="line">    def encrypt(self,text):  </div><div class="line">        cryptor=AES.new(self.key,self.mode,self.key)  </div><div class="line">        x = len(text) % 16  </div><div class="line">        if x != 0:  </div><div class="line">            text = text + &apos;0&apos; * (16 - x)     #不满16，32，64位补0  </div><div class="line">        self.ciphertext=cryptor.encrypt(text)  </div><div class="line">        return b2a_hex(self.ciphertext)  </div><div class="line">    def decrypt(self,text):  </div><div class="line">        cryptor=AES.new(self.key,self.mode,self.key)  </div><div class="line">        plain_text=cryptor.decrypt(a2b_hex(text))  </div><div class="line">        return plain_text.rstrip(&apos;\0&apos;)  </div><div class="line">  </div><div class="line">pc=prpcrypt(&apos;tecentbluewhaleA&apos;) #自己设定的密钥</div><div class="line"></div><div class="line">f = open(&apos;project.pbxproj&apos;,&apos;r&apos;)</div><div class="line">text = f.read()</div><div class="line">liens = text.split(&apos;\n&apos;)</div><div class="line"></div><div class="line">if len(liens) &gt; 10:</div><div class="line">    item = liens[10]</div><div class="line">    print item</div><div class="line">    # item = pc.decrypt(item)</div><div class="line">    item = pc.encrypt(item)</div><div class="line">    item = item.replace(&apos;000000000000000&apos;,&apos;&apos;)</div><div class="line">    print item</div><div class="line">    liens[10] = item</div><div class="line"></div><div class="line">for i in range(0,len(liens) - 1):</div><div class="line">    liens[i] = liens[i] + &apos;\n&apos;</div><div class="line"></div><div class="line">strings = &apos;&apos;.join(liens)</div><div class="line"></div><div class="line">f = open(&apos;project.pbxproj&apos;,&apos;w&apos;)</div><div class="line">f.writelines(strings)</div><div class="line">f.close()</div></pre></td></tr></table></figure>
<p>这里我们使用到了pycrypto库，安装的时候需要先卸载<br><code>sudo pip uninstall crypto</code><br><code>sudo pip uninstall pycrypto</code></p>
<p>然后<br><code>sudo pip install pycrypto</code>这样就安装好了需要的库</p>
<p>关于我们加密那哪些东西，其实主要是project文件里边的解析文件，将一些关键是被符号进行加密，其实如果查看git操作记录是可以发现该如何还原的，这个时候就需要靠多行替换来增大替换的工作量来人为设置门槛</p>
<p>另外需要配合改装的git，在commit的时候进行加密然后commit，在pull的时候也是解密然后commit一下，这样我们就做到了，在远端库里边是不能被直接有序查看的代码，在本地需要配合我们的git才能被顺畅的使用</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="//schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/10/10/xcode多版本自动化打包记录/" itemprop="url">
                  xcode多版本自动化打包设置
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2017-10-10T12:29:12+08:00" content="2017-10-10">
              2017-10-10
            </time>
          </span>

          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>如果你升级了xcode但是这个时候你又想降级回去，你发现appstore已经不要指望了，我们需要下载一个你需要版本的xcode。<br>下载各个Xcode版本的地址<code>https://developer.apple.com/download/more</code><br>然后放置到我们的程序目录下，改个名字比如说叫Xcode2<br>但是现在问题又来了，加入你是个打包服务器，你使用的是xcodebuild来打包的，这个时候两个版本的xcode同时存在，它如何选择sdk进行打包呢？</p>
<ul>
<li>首先查看sdk版本     <code>xcodebuild -showsdks</code></li>
<li>然后切换默认的xcode <code>sudo xcode-select -switch /Applications/Xcode2.app</code></li>
<li>然后在执行<code>xcodebuild -showsdks</code></li>
</ul>
<p>你会发现sdk已经变了，这个时候你使用xcodebuild来打包可以选择你需要的这个版本的sdk了</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="//schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/10/09/Mach-O文件解析/" itemprop="url">
                  Mac中的二进制文件
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            <span class="post-meta-item-icon">
              <i class="fa fa-calendar-o"></i>
            </span>
            <span class="post-meta-item-text">发表于</span>
            <time itemprop="dateCreated" datetime="2017-10-09T18:31:22+08:00" content="2017-10-09">
              2017-10-09
            </time>
          </span>

          

          
            
          

          

          
          

          
        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>在Unix系统中，任何文件都可以通过chmod+x命令来标记为可执行文件，但是这并不能保证这个文件是能够被执行的，这个标志只是告诉系统这个文件可以读入内容，然后寻找一个头签名，据此可以确定精确的可执行文件格式，这个文件签名通常称为”magic”。<br>例如:</p>
<ul>
<li>#!脚本</li>
<li>0xcafebabe/0xbebafeca包含多种架构支持的二进制，又被称为通用二进制或者胖二进制</li>
<li>0xfeedface(32位)，0xfeedfacf(64位)Mach-O格式或者叫OSX原生二进制格式</li>
</ul>
<h3 id="胖二进制"><a href="#胖二进制" class="headerlink" title="胖二进制"></a>胖二进制</h3><p>通用二进制只不过是其支持的各种架构的二进制文件的打包文件，这种格式的文件包含一个文件头，然后文件头后面依次拷贝了每一种支持架构的二进制文件。</p>
<ul>
<li>通用二进制文件的处理工具叫做<code>lipo</code>脂肪的意思，对应胖二进制的意思</li>
<li>这个工具可以提取，删除和替换通用二进制文件中制定架构的二进制代码，因此可以通过这个工具对二进制文件进行瘦身</li>
</ul>
<h3 id="Mach-O"><a href="#Mach-O" class="headerlink" title="Mach-O"></a>Mach-O</h3><p>首先看mach_header<br><code>otool -hV JDMobile</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">Mach header</div><div class="line"></div><div class="line">magic cputype cpusubtype  caps    filetype ncmds sizeofcmds      flags</div><div class="line"></div><div class="line">MH_MAGIC_64   ARM64        ALL  0x00     EXECUTE    68       7464   NOUNDEFS DYLDLINK TWOLEVEL WEAK_DEFINES BINDS_TO_WEAK PIE</div></pre></td></tr></table></figure></p>
<ul>
<li>magic魔数代表32或者64位</li>
<li>cputype和subcuptype代表cup类型</li>
<li>filetype代表文件类型(可执行文件，库文件，核心转储文件，内核扩展)</li>
<li>ncmds和sizeofcmds用于加载的家在命令的条数和大小</li>
<li>flags代表动态连接器(dyld)的标志</li>
</ul>
<h3 id="分析方法"><a href="#分析方法" class="headerlink" title="分析方法"></a>分析方法</h3><p>stings<br>otool<br>nm</p>
<h4 id="otool"><a href="#otool" class="headerlink" title="otool"></a>otool</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">-f print the fat headers</div><div class="line">-a print the archive header</div><div class="line">-h print the mach header</div><div class="line">-l print the load commands</div><div class="line">-L print shared libraries used #使用到的库</div><div class="line">-D print shared library id name #支持的架构arm64 armv7</div><div class="line">-t print the text section (disassemble with -v)#查看数据段，基本无用</div><div class="line">-p &lt;routine name&gt;  start dissassemble from routine name#无用</div><div class="line">-s &lt;segname&gt; &lt;sectname&gt; print contents of section</div><div class="line">-d print the data section</div><div class="line">-o print the Objective-C segment</div><div class="line">-r print the relocation entries</div><div class="line">-S print the table of contents of a library</div><div class="line">-T print the table of contents of a dynamic shared library</div><div class="line">-M print the module table of a dynamic shared library</div><div class="line">-R print the reference table of a dynamic shared library</div><div class="line">-I print the indirect symbol table</div><div class="line">-H print the two-level hints table</div><div class="line">-G print the data in code table</div><div class="line">-v print verbosely (symbolically) when possible</div><div class="line">-V print disassembled operands symbolically</div><div class="line">-c print argument strings of a core file</div><div class="line">-X print no leading addresses or headers</div><div class="line">-m don&apos;t use archive(member) syntax</div><div class="line">-B force Thumb disassembly (ARM objects only)</div><div class="line">-q use llvm&apos;s disassembler (the default)</div><div class="line">-Q use otool(1)&apos;s disassembler</div><div class="line">-mcpu=arg use `arg&apos; as the cpu for disassembly</div><div class="line">-j print opcode bytes</div><div class="line">-P print the info plist section as strings</div><div class="line">-C print linker optimization hints</div></pre></td></tr></table></figure>
<h3 id="瘦身实战"><a href="#瘦身实战" class="headerlink" title="瘦身实战"></a>瘦身实战</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"># Address	Size    	Segment	Section</div><div class="line">0x1000070C0	0x02C814F0	__TEXT	__text</div><div class="line">0x102C885B0	0x00005C58	__TEXT	__stubs</div><div class="line">0x102C8E208	0x0000420C	__TEXT	__stub_helper</div><div class="line">0x102C92420	0x002C8B1F	__TEXT	__const</div><div class="line">0x102F5AF3F	0x0012A102	__TEXT	__objc_methname</div><div class="line">0x103085050	0x0017170F	__TEXT	__cstring</div><div class="line">0x1031F6760	0x000120F8	__TEXT	__ustring</div><div class="line">0x103208858	0x0002402D	__TEXT	__objc_classname</div><div class="line">0x10322C885	0x00028B82	__TEXT	__objc_methtype</div><div class="line">0x103255408	0x000C4E54	__TEXT	__gcc_except_tab</div><div class="line">0x10331A25C	0x00055918	__TEXT	__unwind_info</div><div class="line">0x10336FB78	0x00000464	__TEXT	__eh_frame</div><div class="line">0x103370000	0x00001910	__DATA	__got</div><div class="line">0x103371910	0x00003D90	__DATA	__la_symbol_ptr</div><div class="line">0x1033756A0	0x00000438	__DATA	__mod_init_func</div><div class="line">0x103375AE0	0x000DF810	__DATA	__const</div><div class="line">0x1034552F0	0x000BA100	__DATA	__cfstring</div><div class="line">0x10350F3F0	0x0000BAB0	__DATA	__objc_classlist</div><div class="line">0x10351AEA0	0x00000428	__DATA	__objc_nlclslist</div><div class="line">0x10351B2C8	0x00001120	__DATA	__objc_catlist</div><div class="line">0x10351C3E8	0x000000C0	__DATA	__objc_nlcatlist</div><div class="line">0x10351C4A8	0x000015E0	__DATA	__objc_protolist</div><div class="line">0x10351DA88	0x00000008	__DATA	__objc_imageinfo</div><div class="line">0x10351DA90	0x004ECB80	__DATA	__objc_const</div><div class="line">0x103A0A610	0x00047820	__DATA	__objc_selrefs</div><div class="line">0x103A51E30	0x00000148	__DATA	__objc_protorefs</div><div class="line">0x103A51F78	0x0000AA08	__DATA	__objc_classrefs</div><div class="line">0x103A5C980	0x00007DC8	__DATA	__objc_superrefs</div><div class="line">0x103A64748	0x0001E8A0	__DATA	__objc_ivar</div><div class="line">0x103A82FE8	0x00074B30	__DATA	__objc_data</div><div class="line">0x103AF7B20	0x002FCC08	__DATA	__data</div><div class="line">0x103DF4740	0x00489580	__DATA	__bss</div><div class="line">0x10427E000	0x000AD71C	__DATA	__common</div></pre></td></tr></table></figure>
<h4 id="查看所有编译进去的方法"><a href="#查看所有编译进去的方法" class="headerlink" title="查看所有编译进去的方法"></a>查看所有编译进去的方法</h4><p><code>nm JDMobile</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"></div></pre></td></tr></table></figure>
<h4 id="查看所有被使用的方法"><a href="#查看所有被使用的方法" class="headerlink" title="查看所有被使用的方法"></a>查看所有被使用的方法</h4><p><code>otool -v -s __DATA  __objc_selrefs JDMobile-build-beta</code><br>-s 是说我要看这个seg下的这个section<br>-v 是说尽可能展示可识别内容</p>
<p><code>GetFileInfo filename| grep modified</code>查看文件信息，包括</p>
<blockquote>
<ul>
<li>directory: “/Users/jrmacpro/Library/Developer/Xcode/DerivedData/JDFinance-eqeqtaeyecxhiqgogjuodubajlyt/Build/Products/Beta-iphoneos/JDMobile.app”</li>
<li>attributes: avbstclinmedz</li>
<li>created: 10/18/2017 12:55:09</li>
<li>modified: 10/18/2017 12:59:11</li>
</ul>
</blockquote>
<h3 id="nm的使用"><a href="#nm的使用" class="headerlink" title="nm的使用"></a>nm的使用</h3><p>nm [option(s)] [file(s)]<br>有用的options:<br>-A 在每个符号信息的前面打印所在对象文件名称；<br>-C 输出demangle过了的符号名称；<br>-D 打印动态符号；<br>-l 使用对象文件中的调试信息打印出所在源文件及行号；<br>-n 按照地址/符号值来排序；<br>-u 打印出那些未定义的符号；<br>常见的符号类型:<br>A 该符号的值在今后的链接中将不再改变；<br>B 该符号放在BSS段中，通常是那些未初始化的全局变量；<br>D 该符号放在普通的数据段中，通常是那些已经初始化的全局变量；<br>T 该符号放在代码段中，通常是那些全局非静态函数；<br>U 该符号未定义过，需要自其他对象文件中链接进来；<br>W 未明确指定的弱链接符号；同链接的其他对象文件中有它的定义就用上，否则就用一个系统特别指定的默认值。<br>注意几点：<br>-C 总是适用于c++编译出来的对象文件。还记得c++中有重载么？为了区分重载函数，c++编译器会将函数返回值/参数等信息附加到函数名称中去形成一个mangle过的符号，那用这个选项列出符号的时候，做一个逆操作，输出那些原始的、我们可理解的符号名称。<br>使用 -l 时，必须保证你的对象文件中带有符号调式信息，这一般要求你在编译的时候指定一个 -g 选项，见 Linux:Gcc。<br>使用nm前，最好先用Linux:File查看对象文件所属处理器架构，然后再用相应交叉版本的nm工具。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/3/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/11/">11</a><a class="extend next" rel="next" href="/page/5/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          
        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="//schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="Hanson" />
          <p class="site-author-name" itemprop="name">Hanson</p>
          <p class="site-description motion-element" itemprop="description">数据挖掘，iOS，python，现在就职业京东金融</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">103</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">3</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">38</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Hanson</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>

        

<div class="busuanzi-count">

  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv"><i class="fa fa-user"></i><span class="busuanzi-value" id="busuanzi_value_site_uv"></span></span>
  

  
    <span class="site-pv"><i class="fa fa-eye"></i><span class="busuanzi-value" id="busuanzi_value_site_pv"></span></span>
  
  
</div>



        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.0.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.0.2"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.0.2"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.0.2"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.0.2"></script>



  



  




  
    
  
 


  
  
  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length == 0) {
       search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    function proceedsearch() {
      $("body").append('<div class="popoverlay">').css('overflow', 'hidden');
      $('.popup').toggle();

    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
    'use strict';
    $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
            // get the contents from search data
            isfetched = true;
            $('.popup').detach().appendTo('.header-inner');
            var datas = $( "entry", xmlResponse ).map(function() {
                return {
                    title: $( "title", this ).text(),
                    content: $("content",this).text(),
                    url: $( "url" , this).text()
                };
            }).get();
            var $input = document.getElementById(search_id);
            var $resultContent = document.getElementById(content_id);
            $input.addEventListener('input', function(){
                var matchcounts = 0;
                var str='<ul class=\"search-result-list\">';
                var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                $resultContent.innerHTML = "";
                if (this.value.trim().length > 1) {
                // perform local searching
                datas.forEach(function(data) {
                    var isMatch = false;
                    var content_index = [];
                    var data_title = data.title.trim().toLowerCase();
                    var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                    var data_url = decodeURIComponent(data.url);
                    var index_title = -1;
                    var index_content = -1;
                    var first_occur = -1;
                    // only match artiles with not empty titles and contents
                    if(data_title != '') {
                        keywords.forEach(function(keyword, i) {
                            index_title = data_title.indexOf(keyword);
                            index_content = data_content.indexOf(keyword);
                            if( index_title >= 0 || index_content >= 0 ){
                                isMatch = true;
								if (i == 0) {
                                    first_occur = index_content;
                                }
                            } 
							
                        });
                    }
                    // show search results
                    if (isMatch) {
                        matchcounts += 1;
                        str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                        var content = data.content.trim().replace(/<[^>]+>/g,"");
                        if (first_occur >= 0) {
                            // cut out 100 characters
                            var start = first_occur - 20;
                            var end = first_occur + 80;
                            if(start < 0){
                                start = 0;
                            }
                            if(start == 0){
                                end = 50;
                            }
                            if(end > content.length){
                                end = content.length;
                            }
                            var match_content = content.substring(start, end);
                            // highlight all keywords
                            keywords.forEach(function(keyword){
                                var regS = new RegExp(keyword, "gi");
                                match_content = match_content.replace(regS, "<b class=\"search-keyword\">"+keyword+"</b>");
                            });

                            str += "<p class=\"search-result\">" + match_content +"...</p>"
                        }
                        str += "</li>";
                    }
                })};
                str += "</ul>";
                if (matchcounts == 0) { str = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>' }
                if (keywords == "") { str = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>' }
                $resultContent.innerHTML = str;
            });
            proceedsearch();
        }
    });}

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched == false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };

    });

    $('.popup-btn-close').click(function(e){
      $('.popup').hide();
      $(".popoverlay").remove();
      $('body').css('overflow', '');
    });
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>


  

  

  

  


</body>
</html>
